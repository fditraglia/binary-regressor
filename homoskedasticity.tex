%!TEX root = ./main.tex
\section{Identification by Homoskedasticity}
\todo[inline]{This section uses our notation rather than Mahajan's. We'll have to decide what notation we want to use in the paper itself but for the moment I'm trying to avoid confusion by talking about Mahajan's proofs using his own notation while keeping our derivations in the same notation we used on the whiteboard. I think that by assuming the instrument takes on three values (as in Lewbell) and imposing our homoskedasticity assumption we'll get identification in the case where $T^*$ is endogenous so written out this derivation for arbitrary discrete $z$.}

Now suppose that one is prepared to assume that
\begin{equation}
  E[u^2|z]=E[u^2].
  \label{eq:homosked}
\end{equation}
When combined with the usual IV assumption, $E[u|z]=0$, this implies $Var(u|z) = Var(u)$.
Whether this assumption is reasonable, naturally, depends on the application.
When $z$ is the offer of treatment in a randomized controlled trial, for example, Equation \ref{eq:homosked} holds automatically as a consequence of the randomization.
Similarly, in studies based on a ``natural'' rather than controlled experiment one typically argues that the instrument is not merely uncorrelated with $u$ but \emph{independent} of it, so that Equation \ref{eq:homosked} follows.

To see why homoskedasticity with respect to the instrument provides additional identifying information, first express the conditional variance of $y$ as follows
\begin{equation}
 Var(y|z) = \beta^2 Var\left( T^*|z \right) + Var(u|z) + 2\beta Cov(T^*,u|z)
  \label{eq:varyz}
\end{equation}
Under \ref{eq:homosked}, $Var(u|z)$ does not depend on $z$.
Hence the \emph{difference} of conditional variances evaluated at two values $z_a$ and $z_b$ in the support of $z$ is simply
\begin{equation}
  \Delta Var(y|z_a,z_b) = \beta^2\Delta Var(T^*|z_a,z_b) + 2\beta \Delta Cov(T^*,u|z_a, z_b)]
  \label{eq:varydiff}
\end{equation}
Where $\Delta Var(y|z_a,z_b) = Var(y|z = z_a) - Var(y|z = z_b)$, and we define $\Delta Var(T^*|z_a, z_b)$ and $\Delta Cov(T^*,u|z_a,z_b)$ analogously.  

First we simplify the $\Delta Var(T^*|z_a,z_b)$ term.
Since $T$ is conditionally independent of $z$ given $T^*$, 
\begin{eqnarray*}
  P(T=1|z) &=& E_{T^*|z}\left[E\left( T|z,T^* \right)  \right] = E_{T^*|z}\left[E\left( T|T^* \right)  \right]\\
  &=&  P\left( T^* = 1 | z \right) \left( 1-\alpha_1 \right) + \left[ 1 - P\left( T^*=1|z \right) \right] \alpha_0\\
  &=& \alpha_0 + \left( 1 - \alpha_0 - \alpha_1 \right) P(T^*=1|z)
\end{eqnarray*}
Rearranging,
\begin{equation}
  P(T^*=1|z) = \frac{P(T=1|z) - \alpha_0}{1 - \alpha_0 - \alpha_1}
  \label{eq:pTstar|z}
\end{equation}
and accordingly,
\begin{equation}
  Var(T^*|z) = \frac{\left[ P\left( T=1|z \right) - \alpha_0 \right]\left[ 1 - P\left( T=1|z \right) - \alpha_1 \right]}{\left( 1 - \alpha_0 - \alpha_1 \right)^2}
  \label{eq:VarTstar|z}
\end{equation}
Thus, evaluating Equation \ref{eq:VarTstar|z} at $z_a$ and $z_b$ and simplifying,
\begin{equation}
  \Delta Var(y|z_a,z_b) = \frac{\Delta Var(T|z_a,z_b) + \left( \alpha_1 - \alpha_0 \right) \Delta E(T|z_a, z_b) }{\left( 1 - \alpha_0 - \alpha_1 \right)^2}
  \label{eq:vardiffTstar}
\end{equation}
Turning our attention to $\Delta Cov(T^*,u|z_a,z_b)$ first note that
\begin{equation}
  Cov(T^*,u|z) = E_{T^*|z}\left[E\left( T^*u|z,T^* \right)  \right] = P(T^*=1|z)E\left( u|T^*=1,z \right) 
  \label{eq:covTstaru}
\end{equation}
since $E[z|u] = 0$.
Combining this with Equation \ref{eq:pTstar|z} and evaluating at $z_a$ and $z_b$ gives
\begin{equation}
  \Delta Cov(T^*,u|z_a,z_b) = \frac{\left[E\left( T|z_a \right) - \alpha_0\right] m_{1a} - \left[ E(T|z_b) - \alpha_0 \right] m_{1b} }{1 - \alpha_0 - \alpha_1}
  \label{eq:diffCovTstaru}
\end{equation}
where $m_{1a} = E\left[ u|T^*=1,z_a \right]$ and $m_{1b} = E[u|T^*=1,z_b]$.

Both Equations \ref{eq:vardiffTstar} and \ref{eq:diffCovTstaru} involve only observable quantities and the mis-classification rates $\alpha_0$ and $\alpha_1$.
Equation 
