%!TEX root = ./main.tex
\section{Nonidentification}

\subsection{Mahajan's Argument}
Here we show that \citeauthor{Mahajan}'s proof of identification for an endogenous treatment is incorrect.
The problem is subtle so we give his argument in full detail.
We continue to supress dependence on the exogenous covariates $\mathbf{x}$.

The first step of the argument is to show that if one could recover the conditional mean function of $y$ given $T^*$, then a valid and relevant binary instrument would suffice to identify the treatment effect.  
\begin{assump}[Mahajan A2]\mbox{}
  \label{assump:A2} Suppose that $y = c+ \beta T^* + \varepsilon$ where
  \begin{enumerate}[(i)]
    \item $\mathbb{E}[\varepsilon|z]=0$
    \item $\mathbb{P}(T^*=1|z_1)\neq \mathbb{P}(T^*=1|z_2)$
    \item $\mathbb{P}(T = 1| T^* = 0, z) = \alpha_0$, $\mathbb{P}(T = 0| T^* = 1, z) = \alpha_1$
    \item $\alpha_0 + \alpha_1 \neq 1$
  \end{enumerate}
\end{assump}

\begin{res}[Mahajan A2]
  \label{res:A2}
Under Assumption \ref{assump:A2}, knowledge of the mis-classification error rates $\alpha_0, \alpha_1$ suffices to identify $\beta$.
\end{res}
\begin{proof}[Proof of Proposition \ref{res:A2}]
Since $z$ is a valid instrument that does not influence the mis-classification probabilities
\[\mathbb{E}[y|z_k] = c + \beta \mathbb{E}[T^*|z_k] + \mathbb{E}[\varepsilon|z_k] = c + \beta p_k^* = c + \beta \left( \frac{p_k - \alpha_0}{1 - \alpha_0 - \alpha_1} \right)\]
by Equation \ref{eq:pkstar}.
Since $p_k$ is observed, and $z$ takes on two values, this is a system of two linear equations in $c,\beta$ provided that $\alpha_0,\alpha_1$ are known.
A unique solution exists if and only if $p_1 \neq p_2$.
\end{proof}
In his Theorem 1, \cite{Mahajan} proves that $\alpha_0, \alpha_1$ can in fact be identified under the following assumptions.\footnote{Technically, one additional assumption is required, namely that the conditional mean of $y$ given $T^*$ and any covariates would be identified if $T^*$ were observed.}

\citeauthor{Mahajan}'s next step is to argue that $\alpha_0,\alpha_1$ can be identified by applying his Theorem 1.
\begin{assump}[Mahajan A1] Define $\nu = y - \mathbb{E}[y|T^*]$ so that by construction we have $\mathbb{E}[\nu|T^*]=0$. Assume that
  \label{assump:A1}
  \begin{enumerate}[(i)]
    \item $\mathbb{E}[\nu|T^*,T,z] = 0$.\footnote{This is \citeauthor{Mahajan}'s Equation (I).}
    \item $\mathbb{P}(T^*=1|z_1)\neq \mathbb{P}(T^*=1|z_2)$
    \item $\mathbb{P}(T = 1| T^* = 0, z) = \alpha_0$,  $\mathbb{P}(T = 0| T^* = 1, z) = \alpha_1$
    \item $\alpha_0 + \alpha_1 < 1$
    \item $\mathbb{E}[y|T^*=0]\neq \mathbb{E}[y|T^*=1]$
  \end{enumerate}
\end{assump}
\begin{thm}[Mahajan Theorem 1]
  \label{thm:1}
  Under Assumptions \ref{assump:A1}, the mis-classification error rates $\alpha_0, \alpha_1$ are identified as is the conditional mean function $\mathbb{E}[y|T^*]$.
\end{thm}

Notice that the identification of the error rates in \ref{thm:1} does not depend on the interpretation of the conditional mean function $\mathbb{E}[y|T^*]$.
If $T^*$ is an exogenous treatment, the conditional mean coincides with the treatment effect; if it is endogenous, this is not the case.
Nevertheless, the interpretation of $\alpha_0, \alpha_1$ does not depend on whether we can give the conditional mean a causal interpretation.
Based on this observation, \cite{Mahajan} claims that he can rely on \ref{thm:1} to identify $\alpha_0,\alpha_1$ and thus the causal effect $\beta$ via Result \ref{res:A2}.
To do this, he must build a bridge between Assumption \ref{assump:A2} and Assumption \ref{assump:A1} that allows $T^*$ to be endogenous.
\cite{Mahajan} does this by imposing one additional assumption: Equation 11 in his paper.
\begin{assump}[Mahajan Equation 11]
  \label{assump:Eq11}
  Let $y = c + \beta T^* + \varepsilon$ where $\mathbb{E}[\varepsilon|T^*]$ may not be zero and suppose that 
  \[\mathbb{E}[\varepsilon|T^*,T,z] = \mathbb{E}[\varepsilon|T^*]\]
  where $\mathbb{E}[\varepsilon|T^*]$ may not be zero.
\end{assump}
\begin{res}
  \label{res:Eq11}
  Suppose that $y = c + \beta T^* + \varepsilon$ where $E[\varepsilon|z]=0$ and define the unobserved projection error $\nu = y - \mathbb{E}[y|T^*]$.
  Then Assumption \ref{assump:Eq11} implies that $E[\nu|T^*,T,z]=0$, which is Assumption \ref{assump:A1}(i).
\end{res}
\begin{proof}[Proof of Result \ref{res:Eq11}]
  Taking conditional expectations of the causal model,
  \[\mathbb{E}[y|T^*] = c + \beta T^* + \mathbb{E}[\varepsilon|T^*]\]
  which implies that 
  \[\nu = y - c - \beta T^* - \mathbb{E}[\varepsilon|T^*] = \varepsilon - \mathbb{E}[\varepsilon|T^*].\]
  Now, taking conditional expectations of both sides given $T^*,T,z$, we see that 
  \begin{align*}
  \mathbb{E}[\nu|T^*,T,z]&= \mathbb{E}[\varepsilon|T^*,T,z] - \mathbb{E}\left[ \mathbb{E}\left( \left.\varepsilon\right|T^* \right)\left. \right| T,T^*,z \right]\\
  &= \mathbb{E}[\varepsilon|T^*,T,z] - \mathbb{E}\left[ \left.\varepsilon\right|T^* \right] = 0
\end{align*}
by Assumption \ref{assump:Eq11}, since $\mathbb{E}[\varepsilon|T^*]$ is $(T^*,T,z)$--measurable.
\end{proof}

To summarize, \citeauthor{Mahajan}'s claim is equivalent to the proposition that under Assumptions \ref{assump:A2}(i), \ref{assump:A1}(ii)--(v), and \ref{assump:Eq11}, $\beta$ is identified even if $T^*$ is endogenous.
Although Result \ref{res:A2}, Theorem \ref{thm:1} and Result \ref{res:Eq11} are all correct, \citeauthor{Mahajan}'s claim is not.
While Assumption \ref{assump:Eq11} does guarantee that Assumption \ref{assump:A1}(i) holds, when combined with Assumption \ref{assump:A2}(i) it also implies that \ref{assump:A1}(ii) fails if $T^*$ is endogenous.
\begin{pro}[Lack of a First Stage]
  \label{pro:FirstStage}
  Suppose that Assumptions \ref{assump:A2}(i) and \ref{assump:Eq11} hold and $\mathbb{E}[\varepsilon|T^*]\neq0$. Then $\mathbb{P}(T^*=1|z_1) = \mathbb{P}(T^*=1|z_2)$, violating Assumption \ref{assump:A1}(ii). 
\end{pro}
\begin{proof}[Proof of Proposition \ref{pro:FirstStage}]
  By the Law of Iterated Expectations,
  \begin{equation}
    \label{eq:NoSelection}
    \mathbb{E}[\varepsilon|T^*,z] = \mathbb{E}_{T|T^*,z}\left[\mathbb{E}\left(\varepsilon|T^*,T,z \right)  \right] = \mathbb{E}_{T|T^*,z}\left[\mathbb{E}\left(\varepsilon|T^* \right)  \right]
    = \mathbb{E}\left[ \varepsilon|T^* \right]
  \end{equation}
    where the second equality follows from Assumption \ref{assump:Eq11} and the final equality comes from the fact that $\mathbb{E}[\varepsilon|T^*]$ is $(T^*,z)$--measurable. 
  Using our notation from above let $u = c + \varepsilon$ and define $m^*_{tk}=\mathbb{E}[u|T^*=t,z=z_k]$.
  Since $c$ is a constant, by Equation \ref{eq:NoSelection} we see that $m^*_{01}=m^*_{02}$ and $m^*_{11}=m^*_{12}$.
  Now, by Assumption \ref{assump:A2}(i) we have $\mathbb{E}[\varepsilon|z]=0$ so that $\mathbb{E}[u|z_1]= \mathbb{E}[u|z_2] =c$.
  Again using iterated expectations, 
  \begin{align*}
    \mathbb{E}\left[u|z_1 \right] &= \mathbb{E}_{T^*|z_1}\left[\mathbb{E}\left( u|T^*,z_1 \right)  \right] = (1-p_1^*) m^*_{01} + p^*_1 m^*_{11}=c\\
    \mathbb{E}\left[u|z_2 \right] &= \mathbb{E}_{T^*|z_2}\left[\mathbb{E}\left( u|T^*,z_2 \right)  \right] = (1-p_2^*) m^*_{02} + p^*_2 m^*_{12}=c
  \end{align*}
  The preceding two equations, combined with $m^*_{01}=m^*_{02}$ and $m^*_{11}=m^*_{12}$ imply that $p_1^* = p_2^*$ unless $m^*_{01} = m^*_{11} = m^*_{02} = m^*_{12} = c$.
  But this four-way equality is ruled out by the assumption that $\mathbb{E}[\varepsilon|T^*]\neq0$. 
\end{proof}


\paragraph{Mahajan}
\begin{itemize}
  \item Show that Mahajan's Assumption in Equation (11) implies the condition on the $m$ that we claimed.
  \item Show why he needs to use this assumption in order to apply his proof for the exogenous case. 
  \item Show why this assumption implies that there is no first stage.
  \item Point out where exactly the dependency condition is needed in the proof for the exogenous case.
\end{itemize}

\paragraph{Extending the Support of the Instrument:}
Prove that the system is not identified regardless of the value of $K$ by transcribing our notes from the whiteboard.
