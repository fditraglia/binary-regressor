%!TEX root = ./main.tex
\section{Introduction}
Additively separable model
\[
  y = h(T^*,\mathbf{x})+\varepsilon
\]
where $\varepsilon$ is a mean-zero error term, $T^*$ is an endogenous binary regressor of interest and $\mathbf{x}$ is a vector of exogenous controls.
Since $T^*$ is binary, we can re-write this as linear in $T^*$ conditional on $\mathbf{x}$
\begin{align*}
  y &= c(\mathbf{x}) + \beta(\mathbf{x}) T^* + \varepsilon\\
  \beta(\mathbf{x}) &= h(1,\mathbf{x}) - h(0,\mathbf{x})\\
  c(\mathbf{x}) &= h(0,\mathbf{x})
\end{align*}
Goal is to use an instrumental variable $z$ to identify $\beta(\mathbf{x})$ when we observe not $T^*$ but a mis-measured binary surrogate $T$. 

\todo[inline]{Some updated comments on related papers}
\paragraph{How are we different from Ura?}
\begin{enumerate}
  \item We maintain nondifferential measurement error assumption throughout; Ura's main purpose is to relax it.
  \item We focus on an additively separable model; Ura explicitly studies at LATE setting
  \item We obtain point and partial identification results; Ura present only partial identification results
\end{enumerate}

\paragraph{What about Denteh et al?}
\cite{nguimkeu2016estimation} parametric model of endogenous participation with one-sided endogenous mis-reporting (false negatives).
True participation is a normal linear threshold model with covariates $z$ and parameter $\gamma$, and mis-reporting is also a normal linear threshold model with covariates $w$ and parameter $\theta$.
Requires $z$ to be exogenous wrt to all error terms (essentially an instrument) but do not require $w$ to be exogenous.
Need $z$ and $w$ to be different, although there can be overlap.
Definitely a parametric model, although they say normality isn't needed you do need to specify the joint distribution of the error terms.
Requires exclusion restrictions for both participation and measurement error.
Basically they're using parametric assumptions plus exclusion restrictions to get identification in a one-sided mis-classification model.
In contrast we study the problem non-parametrically and allow mis-reporting to depend arbitrarily on $\mathbf{x}$.

\paragraph{Old Introduction:} Many treatments of interest in applied work are binary.
To take a particularly prominent example, consider treatment status in a randomized controlled trial.
Even if the randomization is pristine, which yields a valid binary instrument (the offer of treatment), subjects may select into treatment based on unobservables, and given the many real-world complications that arise in the field, measurement error may be an important concern.
This paper studies the use of a discrete instrumental variable to identify the causal effect of an endogenous, mis-measured, binary treatment in a model with additively separable errors.
Specifically, we consider the following model 
\begin{equation}
  y = h(T^*, \mathbf{x}) + \varepsilon
\end{equation}
where $T^*\in \left\{ 0,1 \right\}$ is a mis-measured, endogenous treatment, $\mathbf{x}$ is a vector of exogenous controls, and $\varepsilon$ is a mean-zero error.
Since $T^*$ is potentially endogenous, $\mathbb{E}[\varepsilon|T^*,\mathbf{x}]$ may not be zero.
Our goal is to non-parametrically estimate the average treatment effect (ATE) function
\begin{equation}
  \tau(\mathbf{x}) = h(1,\mathbf{x}) - h(0,\mathbf{x}).
\end{equation}
using a single discrete instrumental variable $z \in \left\{ z_k \right\}_{k=1}^K$.
We assume throughout that $z$ is a relevant instrument for $T^*$, in other words 
\begin{equation}
\mathbb{P}(T^*=1|z_j,\mathbf{x})\neq \mathbb{P}(T^*=1|z_k,\mathbf{x}), \quad \forall k\neq j.
\end{equation}
While the structural relationship involves $T^*$, we observe only a noisy measure $T$, polluted by non-differential measurement error.
In particular, we assume that
\begin{eqnarray}
  \mathbb{P}(T = 1| T^* = 0, z, \mathbf{x})  &=&  \alpha_0(\mathbf{x})\\
  \mathbb{P}(T = 0| T^* = 1, z, \mathbf{x})  &=&  \alpha_1(\mathbf{x})
\end{eqnarray}
where the mis-classification error rates $\alpha_0(\mathbf{x})$ and $\alpha_1(\mathbf{x})$ can depend on $\mathbf{x}$ but not $z$, and additionally that, conditional on true treatment status, observed treatment status provides no additional information about the error term.
In other words, we assume that
\begin{equation}
  \mathbb{E}[\varepsilon|T^*,T,z,\mathbf{x}] =  \mathbb{E}[\varepsilon|T^*,z,\mathbf{x}].
\end{equation}

Although a relevant case for applied work, the setting we consider here has received little attention in the literature.
The only existing result for the case of an endogenous treatment appears in an important paper by \cite{Mahajan}, who is primarily concerned with the case of an exogenous treatment.
As we show below, \citeauthor{Mahajan}'s identification result for the endogenous treatment case is incorrect.
As far as we are aware, this leaves the problem considered in this paper completely unsolved.

We begin by showing that the proof in Appendix A.2 of \cite{Mahajan} leads to a contradiction.
Throughout his paper, \cite{Mahajan} maintains an assumption (Assumption 4) which he calls the ``Dependency Condition.'' 
This assumption requires that the instrumental variable be relevant, namely that it generates variation in true treatment status.
When extending his result for an exogenous treatment to the more general case of an endogenous one, however, he must impose an additional condition on the model (Equation 11), which turns out to violate the Dependency Condition.
Since one cannot impose the condition in Equation 11 of \cite{Mahajan}, we go on to study the prospects for identification in this model more broadly.
We consider two possibilities.
First, since \citeauthor{Mahajan}'s identification results require only a binary instrument,  we borrow an idea from \cite{Lewbel} and explore whether expanding the support of the instrument yields identification based on moment equations similar to those used by \cite{Mahajan}.
While allowing the instrument to take on additional values does increase the number of available moment conditions, we show that these moments cannot point identify the treatment effect, regardless of how many (finite) values the instrument takes on.

We then consider a new source of identifying information that arises from imposing stronger assumptions on the instrumental variable.
If the instrument is not merely mean independent but in fact \emph{statistically independent} of the regression error term, as in a randomized controlled trial or a true natural experiment, additional moment conditions become available.
We show that adding a conditional second moment independence assumption on the instrument identifies the \emph{difference} of mis-classification rates $\alpha_1(\mathbf{x})-\alpha_0(\mathbf{x})$. 
Because these rates must equal each other when there is no mis-classification error, our result can be used to test a necessary condition for the absence of measurement error.   
It can also be used to construct simple and informative partial identification bounds for the treatment effect.
When one of the mis-classification rates is known, this identifies the treatment effect.
More generally, however, this is not the case.
We go on to show that a conditional third moment independence assumption on the instrument point identifies both $\alpha_0(\mathbf{x})$ and $\alpha_1(\mathbf{x})$ and hence the ATE function $\tau(\mathbf{x})$. 
Both our point identification and partial identification results require only a binary instrument, and lead to simple, closed-form method of moments estimators.

This project is still in progress. 
The present draft focuses on establishing identification in the simplest possible way: by directly solving a set of equations implied by conditional moment restrictions on $\varepsilon$.
Additional results regarding efficient estimation and sharp bounds for $\alpha_0, \alpha_1$ under weaker conditions on the instrumental variable are currently in progress.
For some additional discussion of these results, see our conclusion below in Section 4.

The remainder of this paper is organized as follows. 
In section 2 we discuss the literature in relation to the problem considered here. 
Section 3 introduces notation and assumptions, and presents our main results.
Section 4 concludes.
All proofs appear in the Appendix.

\paragraph{Old Literature Review:}
Measurement error is a pervasive feature of economic data, motivating a long tradition of measurement error modelling in econometrics. 
The textbook case considers a continuous regressor (treatment) subject to classical measurement error in a linear model.
In this setting, the measurement error is assumed to be unrelated to the true, unobserved, value of the treatment of interest.
Regardless of whether this unobserved treatment is exogenous or endogenous, a single valid instrument suffices to identify its effect.
When an instrument is unavailable, \cite{lewbel1997} shows that higher moment assumptions can be used to construct one, provided that the mis-measured treatment is exogenous.
When it is endogenous, \cite{lewbel2012} uses a heteroskedasticity assumption to obtain identification.

Departures from the linear, classical measurement error setting pose serious identification challenges.
One strand of the literature considers relaxing the assumption of linearity while maintaining that of classical measurement error.
\cite{schennach2004}, for example, uses repeated measures of each mis-measured treatment to obtain identification, while \cite{schennach2007} uses an instrumental variable.  
Both papers consider the case of exogenous treatments.\footnote{For comprehensive reviews of the challenges of addressing measurement error in non-linear models, see  \cite{chensurvey} and \cite{SchennachSurvey}.}
More recently, \cite{SongSchennachWhite} rely on a repeated measure of the mis-measured treatment and the existence of a set of additional regressors, conditional upon which the treatment of interest is unrelated to the unobservables, to obtain identification.      
Another strand of the literature considers relaxing the assumption of classical measurement error, by allowing the measurement error to be related to the true value of the unobserved treatment.
\cite{ChenHongTamer} obtain identification in a general class of moment condition models with mis-measured data by relying on the existence of an auxiliary dataset from which they can estimate the measurement error process.
In contrast, \cite{HuSchennach} and \cite{song2015} rely on an instrumental variable and an additional conditional location assumption on the measurement error distribution. 
More recently, \cite{HuShiuWoutersen} use a continuous instrument to identify the ratio of partial effects of two continuous regressors, one measured with error, in a linear single index model.

Many treatments of interest in economics, however, are binary, and in this case classical measurement error is impossible.
Because a true 1 can only be mis-measured as a 0 and a true 0 can only be mis-measured as a 1, the measurement error must be \emph{negatively} correlated with the true treatment status \citep{Aigner,Bollinger}. 
For this reason, even in a textbook linear model, the instrumental variables estimator can only remove the effect of endogeneity, not that of measurement error \citep{FL}. 
Measurement error in a discrete variable is usually called mis-classification.\footnote{For general results on the partial identification of discrete probability distributions using mis-classified observations, see \cite{molinari}.}
The simplest form of mis-classification is so-called \emph{non-differential} measurement error.
In this case, conditional on true treatment status, and possibly a set of exogenous covariates, the measurement error is assumed to be unrelated to all other variables in the system.

A number of papers have studied this problem without the use of instrumental variables under the assumption that the mis-measured binary treatment is exogenous.
The first to address this problem was \cite{Aigner}, who characterized the asymptotic bias of the OLS estimator in this setting, and proposed a technique for correcting it using outside information on the mis-classification process.
Another early contribution by \cite{Bollinger} provides partial identification bounds.
More recently, \cite{ChenHuLewbel} use higher moment assumptions to obtain identification in a linear regression model, and \cite{ChenHuLewbel2} extend these results to the non-parametric setting. 
\cite{HasseltBollinger} and \cite{BollingerHasseltWP} provide additional partial identification results.

Continuing under the assumption of an exogenous treatment, a number of other papers in the literature have considered the identifying power of an instrumental variable, or something like one.
\cite{BBS} and \cite{KRS} more-or-less simultaneously pointed out that when \emph{two} alternative measures of treatment are available, both subject to non-differential measurement error, a non-linear GMM estimator can be used to recover the treatment effect.
In essence, one measure serves as an instrument for the other although the estimator is quite different from IV.\footnote{Ignoring covariates, the observable moments in this case are the joint probability distribution of the two binary treatment measures and the conditional means of the outcome variable given the two measures. Although the system is highly non-linear, it can be manipulated to yield an explicit solution for the treatment effect provided that the true treatment is exogenous.}
Subsequently, \cite{FL} correctly note that an instrumental variable can take the place of one of the measures of treatment in a linear model with an exogenous treatment, allowing one to implement a variant of the GMM estimator proposed by \cite{BBS} and \cite{KRS}.
However, as we will show below, the assumptions required to obtain this result are stronger than \cite{FL} appear to realize: the usual IV assumption that the instrument is mean independent of the regression error is insufficient for identification. 

\cite{Mahajan} extends the results of \cite{BBS} and \cite{KRS} to a more general nonparametric regression setting using a binary instrument in place of one of the treatment measures. 
Although unaware of \cite{FL}, \cite{Mahajan} makes the correct assumption over the instrument and treatment to guarantee identification of the conditional mean function.
When the treatment is in fact exogenous, this coincides with the treatment effect.
\cite{hu2008} derives related results when the mis-classified discrete regressor may take on more than two values.
\cite{Lewbel} provides an identification result for the same model as \cite{Mahajan} under different assumptions.
In particular, the variable that plays the role of the ``instrument'' need not satisfy the exclusion restriction provided that it does not interact with the treatment and takes on at least three distinct values. 

Much less is known about the case in which a binary, or discrete, treatment is not only mis-measured but endogenous.
\cite{FL} briefly discuss the prospects for identification in this setting.
Although they do not provide a formal proof they argue, in the context of their parametric linear model, that the treatment effect is unlikely to be identified unless one is willing to impose strong and somewhat unnatural conditions.\footnote{For example, one could consider using the results of \cite{Hausman}, who study regressions with a mis-classified, discrete \emph{outcome} variable, as a first-stage in an IV setting. In principle, this approach would fully identify the mis-classification error process. Using these results, however, requires either an explicit, nonlinear, parametric model for the first stage, or an identification at infinity argument.} 
The first paper to provide a formal result for this case is \cite{Mahajan}.
He extends his main result to the case of an endogenous treatment, providing an explicit proof of identification under the usual IV assumption in a model with additively separable errors.
As we show below, however, \citeauthor{Mahajan}'s proof is incorrect.

The results we derive here most closely relate to the setting considered in \cite{Mahajan} in that we study non-parametric identification of the effect of a binary, endogenous treatment, using a discrete instrument.
Unlike \cite{Mahajan} we consider and indeed show the necessity of using higher-moment information to identify the causal effect of interest.
Unlike \cite{kreider2012}, who partially identify the effects of food stamps on health outcomes of children under weak measurement error assumptions, we do not rely on auxiliary data. 
Unlike \cite{shiu2015}, who considers a sample selection model with a discrete, mis-measured, endogenous regressor, we do not rely on a parametric assumption about the form of the first-stage.
Finally unlike \cite{Ura}, who studies local average treatment effects under very general forms of mis-classification but presents only partial identification results, we point identify an average treatment effect under non-differential measurement error.
Moreover, unlike the identification strategies from the existing literature described above, we do not rely upon continuity of the instrument, a large support condition, or restrictions on the relationship between the true, unmeasured treatment and its observed surrogate, subject to the condition that the measurement error process is non-differential.

\todo[inline]{Change from here UPWARDS}

The remainder of the paper is organized as follows.
Section \ref{sec:baseline} describes our model and assumptions, Section \ref{sec:ident_literature} relates our results to existing work, and Sections \ref{sec:partial}--\ref{sec:point} present our identification results.
Section \ref{sec:problem} points out the special inferential difficulties that arise in models with mis-classification while Section \ref{sec:overview} gives a high-level overview of our proposed inference procedure.
Full details of the procedure follow in Sections \ref{sec:inequalities}--\ref{sec:details}.
Section \ref{sec:simulation} presents simulation results, and Section \ref{sec:conclusion} concludes.
Proofs appear in Appendix \ref{sec:proofs}, and we give a detailed explanation of the error in \cite{Mahajan} in Appendix \ref{sec:mahajan}.


